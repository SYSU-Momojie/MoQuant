<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cn.momojie.moquant.api.dao.MqQuarterBasicDao">
  <resultMap id="BaseResultMap" type="com.cn.momojie.moquant.api.dto.MqQuarterBasic">
    <id column="ts_code" jdbcType="VARCHAR" property="tsCode" />
    <id column="update_date" jdbcType="VARCHAR" property="updateDate" />
    <id column="report_period" jdbcType="VARCHAR" property="reportPeriod" />
    <id column="forecast_period" jdbcType="VARCHAR" property="forecastPeriod" />
    <result column="share_name" jdbcType="VARCHAR" property="shareName" />
    <result column="revenue_period" jdbcType="VARCHAR" property="revenuePeriod" />
    <result column="revenue" jdbcType="DECIMAL" property="revenue" />
    <result column="revenue_ly" jdbcType="DECIMAL" property="revenueLy" />
    <result column="revenue_yoy" jdbcType="DECIMAL" property="revenueYoy" />
    <result column="quarter_revenue" jdbcType="DECIMAL" property="quarterRevenue" />
    <result column="quarter_revenue_ly" jdbcType="DECIMAL" property="quarterRevenueLy" />
    <result column="quarter_revenue_yoy" jdbcType="DECIMAL" property="quarterRevenueYoy" />
    <result column="nprofit_period" jdbcType="VARCHAR" property="nprofitPeriod" />
    <result column="nprofit" jdbcType="DECIMAL" property="nprofit" />
    <result column="nprofit_ly" jdbcType="DECIMAL" property="nprofitLy" />
    <result column="nprofit_yoy" jdbcType="DECIMAL" property="nprofitYoy" />
    <result column="quarter_nprofit" jdbcType="DECIMAL" property="quarterNprofit" />
    <result column="quarter_nprofit_ly" jdbcType="DECIMAL" property="quarterNprofitLy" />
    <result column="quarter_nprofit_yoy" jdbcType="DECIMAL" property="quarterNprofitYoy" />
    <result column="nprofit_ltm" jdbcType="DECIMAL" property="nprofitLtm" />
    <result column="dprofit_period" jdbcType="VARCHAR" property="dprofitPeriod" />
    <result column="dprofit" jdbcType="DECIMAL" property="dprofit" />
    <result column="dprofit_ly" jdbcType="DECIMAL" property="dprofitLy" />
    <result column="dprofit_yoy" jdbcType="DECIMAL" property="dprofitYoy" />
    <result column="quarter_dprofit" jdbcType="DECIMAL" property="quarterDprofit" />
    <result column="quarter_dprofit_ly" jdbcType="DECIMAL" property="quarterDprofitLy" />
    <result column="quarter_dprofit_yoy" jdbcType="DECIMAL" property="quarterDprofitYoy" />
    <result column="dprofit_ltm" jdbcType="DECIMAL" property="dprofitLtm" />
    <result column="nassets" jdbcType="DECIMAL" property="nassets" />
  </resultMap>

    <select id="selectLatestByCode" resultMap="BaseResultMap">
        SELECT *
        FROM mq_quarter_basic
        WHERE ts_code=#{code}
        ORDER BY update_date DESC, forecast_period DESC, report_period DESC
        LIMIT 1
    </select>

    <select id="selectTrendByCode" resultMap="BaseResultMap">
        SELECT *
        FROM mq_quarter_basic
        WHERE ts_code=#{code}
        ORDER BY update_date ASC
    </select>
</mapper>